<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>国産第1号</title>
  <style>
    /* ページ全体の初期設定 */
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: sans-serif;
      background: #2e2e2e; /* 鋼黒を基調としたベースカラー */
      overflow: hidden;
    }
    /* グラデーションアニメーションの背景 */
    .gradient-bg {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(45deg, rgba(70,70,70,0.5), rgba(0,0,0,0.5));
      background-size: 400% 400%;
      animation: gradientAnimation 15s ease infinite;
      z-index: -1;
    }
    @keyframes gradientAnimation {
      0% {
        background-position: 0% 50%;
      }
      50% {
        background-position: 100% 50%;
      }
      100% {
        background-position: 0% 50%;
      }
    }
    /* コンテナ設定 */
    .container {
      position: relative;
      z-index: 1;
      color: white;
      padding: 20px;
    }
    /* 投稿フォームと投稿一覧のレイアウト（Twitter に似たシンプルなスタイル） */
    .post-form, .posts {
      max-width: 600px;
      margin: 20px auto;
      background: rgba(0,0,0,0.6);
      padding: 20px;
      border-radius: 10px;
    }
    .post {
      border-bottom: 1px solid #555;
      padding: 10px 0;
    }
  </style>
</head>
<body>
  <div class="gradient-bg"></div>
  <div class="container">
    <h1>国産第1号</h1>
    <div class="post-form">
      <h2>新規投稿</h2>
      <form id="postForm">
        <input type="text" id="user" placeholder="ユーザー名" required style="width:100%; padding:10px; margin-bottom:10px;">
        <textarea id="content" placeholder="内容" required style="width:100%; padding:10px; margin-bottom:10px;"></textarea>
        <button type="submit" style="padding:10px 20px;">投稿する</button>
      </form>
    </div>
    <div class="posts" id="posts">
      <h2>投稿一覧</h2>
      <!-- 投稿一覧はここに動的に挿入 -->
    </div>
  </div>
  <script>
    // 投稿一覧を取得して表示
    async function fetchPosts() {
      const res = await fetch('/api/posts');
      const posts = await res.json();
      const postsContainer = document.getElementById('posts');
      postsContainer.innerHTML = '<h2>投稿一覧</h2>';
      posts.forEach(post => {
        const postEl = document.createElement('div');
        postEl.className = 'post';
        postEl.innerHTML = '<strong>' + post.user + '</strong>: ' + post.content;
        postsContainer.appendChild(postEl);
      });
    }

    // 投稿フォームの送信処理
    document.getElementById('postForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      const user = document.getElementById('user').value;
      const content = document.getElementById('content').value;
      const res = await fetch('/api/posts', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ user, content })
      });
      if (res.ok) {
        document.getElementById('postForm').reset();
        fetchPosts();
      }
    });

    // 初回ロード時に投稿一覧を取得
    fetchPosts();
  </script>
</body>
</html>
